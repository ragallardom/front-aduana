<!-- src/app/pages/solicitudes-aduana/formulario-solicitud/formulario-solicitud.component.html -->
<div class="container">
  <h2 class="mb-4">Registrar Nueva Solicitud Aduana</h2>

  <!-- Mensaje de error general -->
  <div *ngIf="errorMsg" class="alert alert-danger">
    {{ errorMsg }}
  </div>

  <form
    [formGroup]="formulario"
    (ngSubmit)="guardar()"
  >
    <!-- Datos del menor -->
    <fieldset class="mb-4">
      <legend class="fs-5">Datos del menor</legend>

      <!-- Tipo de solicitud -->
      <div class="mb-3">
        <label class="form-label d-block">Tipo de solicitud</label>
        <div class="btn-group" role="group" aria-label="Tipo Solicitud">
          <input
            type="radio"
            class="btn-check"
            formControlName="tipoSolicitudMenor"
            value="Entrada"
            id="solicitud-entrada"
          />
          <label class="btn btn-outline-primary" for="solicitud-entrada"
            >Entrada</label
          >

          <input
            type="radio"
            class="btn-check"
            formControlName="tipoSolicitudMenor"
            value="Salida"
            id="solicitud-salida"
          />
          <label class="btn btn-outline-primary" for="solicitud-salida"
            >Salida</label
          >
        </div>
        <div
          *ngIf="
            formulario.get('tipoSolicitudMenor')?.invalid &&
            formulario.get('tipoSolicitudMenor')?.touched
          "
          class="text-danger mt-1"
        >
          Debes seleccionar el tipo de solicitud.
        </div>
      </div>

      <!-- Nombre completo del menor -->
      <div class="mb-3">
        <label class="form-label">Nombre completo del menor</label>
        <input
          type="text"
          formControlName="nombreMenor"
          class="form-control"
        />
        <div
          *ngIf="
            formulario.get('nombreMenor')?.invalid &&
            formulario.get('nombreMenor')?.touched
          "
          class="text-danger"
        >
          El nombre del menor es obligatorio.
        </div>
      </div>

      <!-- Fecha de nacimiento -->
      <div class="mb-3">
        <label class="form-label">Fecha de nacimiento</label>
        <input
          type="date"
          formControlName="fechaNacimientoMenor"
          class="form-control"
        />
        <div
          *ngIf="
            formulario.get('fechaNacimientoMenor')?.invalid &&
            formulario.get('fechaNacimientoMenor')?.touched
          "
          class="text-danger"
        >
          La fecha de nacimiento es obligatoria.
        </div>
      </div>

      <!-- Tipo Documento del menor -->
      <div class="mb-3">
        <label class="form-label d-block">Documento del menor</label>
        <div class="btn-group" role="group" aria-label="Tipo Documento Menor">
          <input
            type="radio"
            class="btn-check"
            formControlName="documentoMenor"
            value="RUT"
            id="menor-rut"
          />
          <label class="btn btn-outline-primary" for="menor-rut">RUT</label>

          <input
            type="radio"
            class="btn-check"
            formControlName="documentoMenor"
            value="Pasaporte"
            id="menor-pasaporte"
          />
          <label class="btn btn-outline-primary" for="menor-pasaporte"
            >Pasaporte</label
          >
        </div>
      <div
        *ngIf="
          formulario.get('documentoMenor')?.invalid &&
          formulario.get('documentoMenor')?.touched
        "
        class="text-danger mt-1"
      >
        Debes seleccionar el documento.
      </div>
    </div>

    <div class="mb-3" *ngIf="formulario.get('documentoMenor')?.value === 'RUT'">
      <label class="form-label">RUT del menor</label>
      <input
        type="text"
        formControlName="numeroDocumentoMenor"
        class="form-control"
      />
      <div
        *ngIf="
          formulario.get('numeroDocumentoMenor')?.invalid &&
          formulario.get('numeroDocumentoMenor')?.touched
        "
        class="text-danger"
      >
        Ingresa un RUT válido.
      </div>
    </div>
    <div class="mb-3" *ngIf="formulario.get('documentoMenor')?.value === 'Pasaporte'">
      <label class="form-label">Pasaporte del menor</label>
      <input
        type="text"
        formControlName="numeroDocumentoMenor"
        class="form-control"
      />
      <div
        *ngIf="
          formulario.get('numeroDocumentoMenor')?.invalid &&
          formulario.get('numeroDocumentoMenor')?.touched
        "
        class="text-danger"
      >
        El número de pasaporte es obligatorio.
      </div>
    </div>

      <!-- Nacionalidad -->
      <div class="mb-3">
        <label class="form-label">Nacionalidad</label>
        <select formControlName="nacionalidadMenor" class="form-select">
          <option value="" disabled>-- Selecciona --</option>
          <option value="Chilena">Chilena</option>
          <option value="Argentina">Argentina</option>
          <option value="Peruana">Peruana</option>
          <option value="Uruguaya">Uruguaya</option>
          <option value="Paraguaya">Paraguaya</option>
          <option value="Boliviana">Boliviana</option>
          <option value="Colombiana">Colombiana</option>
        </select>
        <div
          *ngIf="
            formulario.get('nacionalidadMenor')?.invalid &&
            formulario.get('nacionalidadMenor')?.touched
          "
          class="text-danger"
        >
          Debes seleccionar la nacionalidad.
        </div>
      </div>
    </fieldset>

    <!-- Datos de los padres o tutores legales -->
    <fieldset class="mb-4">
      <legend class="fs-5">Datos de los padres o tutores legales</legend>

      <!-- Nombre completo del padre/madre -->
      <div class="mb-3">
        <label class="form-label">Nombre completo (Padre/Madre)</label>
        <input
          type="text"
          formControlName="nombrePadreMadre"
          class="form-control"
        />
        <div
          *ngIf="
            formulario.get('nombrePadreMadre')?.invalid &&
            formulario.get('nombrePadreMadre')?.touched
          "
          class="text-danger"
        >
          El nombre es obligatorio.
        </div>
      </div>

      <!-- Relación con el menor -->
      <div class="mb-3">
        <label class="form-label">Relación con el menor</label>
        <select formControlName="relacionMenor" class="form-select">
          <option value="" disabled>-- Selecciona --</option>
          <option value="Padre">Padre</option>
          <option value="Madre">Madre</option>
          <option value="Tutor legal">Tutor legal</option>
        </select>
        <div
          *ngIf="
            formulario.get('relacionMenor')?.invalid &&
            formulario.get('relacionMenor')?.touched
          "
          class="text-danger"
        >
          Debes indicar la relación con el menor.
        </div>
      </div>

      <!-- Tipo Documento del padre o tutor -->
      <div class="mb-3">
        <label class="form-label d-block">Documento del padre o tutor</label>
        <div class="btn-group" role="group" aria-label="Tipo Documento Padre">
          <input
            type="radio"
            class="btn-check"
            formControlName="documentoPadre"
            value="RUT"
            id="padre-rut"
          />
          <label class="btn btn-outline-primary" for="padre-rut">RUT</label>

          <input
            type="radio"
            class="btn-check"
            formControlName="documentoPadre"
            value="Pasaporte"
            id="padre-pasaporte"
          />
          <label class="btn btn-outline-primary" for="padre-pasaporte"
            >Pasaporte</label
          >
        </div>
      <div
        *ngIf="
          formulario.get('documentoPadre')?.invalid &&
          formulario.get('documentoPadre')?.touched
        "
        class="text-danger mt-1"
      >
        Debes seleccionar el documento.
      </div>
    </div>

    <div class="mb-3" *ngIf="formulario.get('documentoPadre')?.value === 'RUT'">
      <label class="form-label">RUT del padre o tutor</label>
      <input
        type="text"
        formControlName="numeroDocumentoPadre"
        class="form-control"
      />
      <div
        *ngIf="
          formulario.get('numeroDocumentoPadre')?.invalid &&
          formulario.get('numeroDocumentoPadre')?.touched
        "
        class="text-danger"
      >
        Ingresa un RUT válido.
      </div>
    </div>
    <div class="mb-3" *ngIf="formulario.get('documentoPadre')?.value === 'Pasaporte'">
      <label class="form-label">Pasaporte del padre o tutor</label>
      <input
        type="text"
        formControlName="numeroDocumentoPadre"
        class="form-control"
      />
      <div
        *ngIf="
          formulario.get('numeroDocumentoPadre')?.invalid &&
          formulario.get('numeroDocumentoPadre')?.touched
        "
        class="text-danger"
      >
        El número de pasaporte es obligatorio.
      </div>
    </div>

      <!-- Teléfono -->
      <div class="mb-3">
        <label class="form-label">Teléfono de contacto</label>
        <input
          type="text"
          formControlName="telefonoPadre"
          class="form-control"
        />
        <div
          *ngIf="
            formulario.get('telefonoPadre')?.invalid &&
            formulario.get('telefonoPadre')?.touched
          "
          class="text-danger"
        >
          El teléfono es obligatorio.
        </div>
      </div>

      <!-- Email -->
      <div class="mb-3">
        <label class="form-label">Email</label>
        <input
          type="email"
          formControlName="emailPadre"
          class="form-control"
        />
        <div
          *ngIf="
            formulario.get('emailPadre')?.invalid &&
            formulario.get('emailPadre')?.touched
          "
          class="text-danger"
        >
          Ingresa un correo electrónico válido.
        </div>
      </div>
    </fieldset>

    <!-- Nombre del Solicitante -->
    <div class="mb-3">
      <label class="form-label">Nombre Solicitante</label>
      <input
        type="text"
        formControlName="nombreSolicitante"
        class="form-control"
      />
      <div
        *ngIf="
          formulario.get('nombreSolicitante')?.invalid &&
          formulario.get('nombreSolicitante')?.touched
        "
        class="text-danger"
      >
        El nombre del solicitante es obligatorio.
      </div>
    </div>

    <!-- Tipo de Documento -->
    <div class="mb-3">
      <label class="form-label d-block">Tipo Documento</label>
      <div class="btn-group" role="group" aria-label="Tipo Documento">
        <input
          type="radio"
          class="btn-check"
          formControlName="tipoDocumento"
          value="RUT"
          id="tipo-rut"
        />
        <label class="btn btn-outline-primary" for="tipo-rut">RUT</label>

        <input
          type="radio"
          class="btn-check"
          formControlName="tipoDocumento"
          value="Pasaporte"
          id="tipo-pasaporte"
        />
        <label class="btn btn-outline-primary" for="tipo-pasaporte">Pasaporte</label>
      </div>
      <div
        *ngIf="
          formulario.get('tipoDocumento')?.invalid &&
          formulario.get('tipoDocumento')?.touched
        "
        class="text-danger mt-1"
      >
        El tipo de documento es obligatorio.
      </div>
    </div>

    <!-- Número de Documento -->
    <div class="mb-3" *ngIf="formulario.get('tipoDocumento')?.value === 'RUT'">
      <label class="form-label">RUT</label>
      <input
        type="text"
        formControlName="numeroDocumento"
        class="form-control"
      />
      <div
        *ngIf="
          formulario.get('numeroDocumento')?.invalid &&
          formulario.get('numeroDocumento')?.touched
        "
        class="text-danger"
      >
        Ingresa un RUT válido.
      </div>
    </div>
    <div class="mb-3" *ngIf="formulario.get('tipoDocumento')?.value === 'Pasaporte'">
      <label class="form-label">Número Pasaporte</label>
      <input
        type="text"
        formControlName="numeroDocumento"
        class="form-control"
      />
      <div
        *ngIf="
          formulario.get('numeroDocumento')?.invalid &&
          formulario.get('numeroDocumento')?.touched
        "
        class="text-danger"
      >
        El número de pasaporte es obligatorio.
      </div>
    </div>

    <!-- Motivo -->
    <div class="mb-3">
      <label class="form-label">Motivo</label>
      <input type="text" formControlName="motivo" class="form-control" />
      <div
        *ngIf="
          formulario.get('motivo')?.invalid &&
          formulario.get('motivo')?.touched
        "
        class="text-danger"
      >
        El motivo es obligatorio.
      </div>
    </div>

    <!-- País de Origen -->
    <div class="mb-3">
      <label class="form-label">País Origen</label>
      <input type="text" formControlName="paisOrigen" class="form-control" />
      <div
        *ngIf="
          formulario.get('paisOrigen')?.invalid &&
          formulario.get('paisOrigen')?.touched
        "
        class="text-danger"
      >
        El país de origen es obligatorio.
      </div>
    </div>

    <!-- Tipo de Documento Adjunto -->
    <div class="mb-3">
      <label class="form-label">Tipo Documento Adjunto</label>
      <select formControlName="tipoAdjunto" class="form-select">
        <option value="" disabled>-- Selecciona un tipo --</option>
        <option
          *ngFor="let tipo of tiposAdjunto"
          [value]="tipo"
        >
          {{ tipo }}
        </option>
      </select>
      <div
        *ngIf="
          formulario.get('tipoAdjunto')?.invalid &&
          formulario.get('tipoAdjunto')?.touched
        "
        class="text-danger"
      >
        Debes elegir un tipo de documento adjunto.
      </div>
    </div>

    <!-- Archivo -->
    <div class="mb-3">
      <label class="form-label">Archivo (PDF, JPG, etc.)</label>
      <input
        type="file"
        (change)="onFileChange($event)"
        class="form-control"
      />
      <div
        *ngIf="!archivoSeleccionado"
        class="text-danger"
      >
        Debes seleccionar un archivo.
      </div>
    </div>

    <!-- Botones -->
    <button
      type="submit"
      class="btn btn-primary me-2"
      [disabled]="formulario.invalid"
    >
      Guardar Solicitud
    </button>
    <button
      type="button"
      class="btn btn-secondary"
      (click)="cancelar()"
    >
      Cancelar
    </button>
  </form>
</div>
